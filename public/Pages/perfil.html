<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/css/style.css" />
  <link rel="stylesheet" href="/css/menu.css" />
  <link rel="stylesheet" href="/css/perfil.css" />
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  <title>Iyayku ‚Äì Perfil</title>
</head>
<body class="bg-blue-800 text-white font-sans">
  <header class="bg-white text-black flex flex-wrap items-center justify-between px-6 py-4 shadow-md">
    <div class="logo flex-shrink-0">
      <img src="/img/logo" alt="Logo" class="h-12 object-contain" />
    </div>
    <nav id="main-menu" class="w-full md:w-auto md:flex md:items-center mt-4 md:mt-0 hidden md:block">
      <ul class="flex flex-col md:flex-row gap-4 letras_menu w-full md:w-auto">
        <li><a href="/index.html" class="hover-effect block py-2 px-4">Inicio</a></li>
        <li><a href="/Pages/nosotros.html" class="hover-effect block py-2 px-4">Nosotros</a></li>
        <li><a href="/Pages/editorial.html" class="hover-effect block py-2 px-4">Editorial</a></li>
        <li><a href="/Pages/servicios.html" class="hover-effect block py-2 px-4">Servicios</a></li>
        <li><a href="/Pages/contacto.html" class="hover-effect block py-2 px-4">Cont√°ctanos</a></li>
      </ul>
    </nav>
    <div class="social-icons">
      <a href="/Pages/registro_login.html" title="Iniciar sesi√≥n o registrarse">
        <div class="w-10 h-10 rounded-full bg-gray-300 flex items-center justify-center hover:bg-blue-500 transition">
          <img src="/img/user" alt="Usuario" class="w-6 h-6 text-white" />
        </div>
      </a>
      <!-- WhatsApp -->
      <a href="https://api.whatsapp.com/send?phone=593997000496&text=%C2%A1Hola%20Iyayku%20Innova%20Editores!%20me%20gustar%C3%ADa%20saber%20m%C3%A1s%20informaci%C3%B3n%20acerca%20de%20la%20asesor%C3%ADa%20y%20publicaci%C3%B3n%20de%20art%C3%ADculos%20cient%C3%ADficos.%20%E2%9C%8D%EF%B8%8F%F0%9F%93%8A%F0%9F%93%9D"
        target="_blank" rel="noopener noreferrer">
        <img src="/img/whatsapp" alt="WhatsApp" class="h-5 w-5 hover:scale-110 transition" />
      </a>
      <!-- Facebook -->
      <a href="https://www.facebook.com/Iyaykutec" target="_blank" rel="noopener noreferrer">
        <img src="/img/facebook" alt="Facebook" class="h-5 w-5 hover:scale-110 transition" />
      </a>
      <!-- Instagram -->
      <a href="https://www.instagram.com/iyaykutec" target="_blank" rel="noopener noreferrer">
        <img src="/img/instagram" alt="Instagram" class="h-5 w-5 hover:scale-110 transition" />
      </a>
      <!-- Buscar -->
      <a id="searchToggle" class="cursor-pointer">
        <img src="/img/lupa" alt="Buscar" class="h-5 w-5 hover:scale-110 transition" />
      </a>
      <!-- Campo de b√∫squeda oculto -->
      <input id="searchInput" type="text" placeholder="Buscar..."
        class="hidden ml-2 px-2 py-1 rounded border border-gray-300 shadow text-black transition-all duration-300" />
    </div>
  </header>
  <!-- LOGIN STATUS BANNER -->
  <div id="login-status-banner" style="display:none;position:fixed;top:0;right:0;z-index:9999;background:#3498db;color:#fff;padding:8px 18px;border-radius:0 0 0 12px;font-weight:600;box-shadow:0 2px 8px rgba(0,0,0,0.10);">
    <span id="login-status-text"></span>
    <a id="perfil-link" href="/Pages/perfil.html" style="color:#fff;text-decoration:underline;margin-left:10px;display:none;">Ir a perfil</a>
  </div>
  <main class="admin-dashboard-main admin-dashboard-main-blanco">
    <!-- Sidebar -->
    <aside class="admin-sidebar">
      <div class="admin-sidebar-content">
        <div class="admin-title">Admin</div>
        <nav>
          <ul>
            <li>
              <a href="#" class="active">
                <span class="icon">üë§</span> Editar Perfil
              </a>
            </li>
            <li>
              <a href="#">
                <span class="icon">üßæ</span> Facturas
              </a>
            </li>
            <li>
              <a href="#">
                <span class="icon">üéì</span> Certificados
              </a>
            </li>
            <li>
              <a href="#">
                <span class="icon">üìù</span> Editar p√°gina
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </aside>
    <!-- Main dashboard content -->
    <section class="admin-dashboard-content">
      <div class="admin-dashboard-blank"></div>
      <div class="admin-dashboard-welcome">
        ¬°Bienvenido, Administrador!
      </div>
      <div class="admin-dashboard-cards">
        <div class="admin-card card-perfil">
          <div class="icon">üë§</div>
          <div>Editar Perfil</div>
        </div>
        <div id="admin-usuarios-panel" class="admin-panel" style="display:none">
          <h3>Usuarios registrados</h3>
          <table id="admin-usuarios-table">
            <thead><tr><th>Nombre</th><th>Correo</th><th>Acciones</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="admin-card card-facturas">
          <div class="icon">üßæ</div>
          <div>Facturas</div>
        </div>
        <div id="admin-facturas-panel" class="admin-panel" style="display:none">
          <h3>Facturas</h3>
          <form id="form-factura" style="margin-bottom:16px;">
            <input type="number" name="usuario_id" placeholder="ID Usuario" required style="width:80px;">
            <input type="number" name="total" placeholder="Total" required step="0.01" style="width:80px;">
            <input type="text" name="items" placeholder='Items (JSON)' required style="width:200px;">
            <button type="submit">Agregar</button>
            <small>Ejemplo items: [{"nombre":"Servicio","cantidad":1,"precio":10}]</small>
          </form>
          <table id="admin-facturas-table">
            <thead><tr><th>ID</th><th>Usuario</th><th>Correo</th><th>Fecha</th><th>Total</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="admin-card card-certificados">
          <div class="icon">üéì</div>
          <div>Certificados</div>
        </div>
        <div id="admin-certificados-panel" class="admin-panel" style="display:none">
          <h3>Certificados</h3>
          <form id="form-certificado" style="margin-bottom:16px;">
            <input type="text" name="autor_nombre" placeholder="Autor" required style="width:120px;">
            <input type="text" name="articulo_titulo" placeholder="T√≠tulo" required style="width:120px;">
            <input type="url" name="articulo_url" placeholder="URL PDF" style="width:120px;">
            <input type="text" name="publicacion_id" placeholder="ID Publicaci√≥n (opcional)" style="width:80px;">
            <button type="submit">Agregar</button>
          </form>
          <table id="admin-certificados-table">
            <thead><tr><th>ID</th><th>Autor</th><th>T√≠tulo</th><th>PDF</th><th>P√°gina</th><th>Fecha</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="admin-card card-editar">
          <div class="icon">üìù</div>
          <div>Editar p√°gina</div>
        </div>
        <div id="admin-editar-panel" class="admin-panel" style="display:none;max-width:900px;">
          <h3>Editar cualquier secci√≥n de la web</h3>
          <form id="form-editar-seccion" style="margin-bottom:10px;display:flex;gap:8px;flex-wrap:wrap;align-items:center;">
            <label>P√°gina:
              <select id="select-pagina" required style="min-width:120px;"></select>
            </label>
            <label>Secci√≥n:
              <select id="select-seccion" required style="min-width:120px;"></select>
            </label>
            <label>T√≠tulo:
              <input id="input-titulo" type="text" style="min-width:120px;" />
            </label>
            <button type="button" id="btn-cargar-seccion">Cargar</button>
          </form>
          <div style="display:flex;gap:16px;align-items:flex-start;">
            <div style="flex:1;min-width:350px;">
              <div style="margin-bottom:4px;display:flex;align-items:center;gap:8px;">
                <button type="button" id="btn-modo-visual" class="btn-modo" style="padding:2px 8px;">Editor Visual</button>
                <button type="button" id="btn-modo-html" class="btn-modo" style="padding:2px 8px;">HTML</button>
              </div>
              <div id="editor-container" style="height:300px;background:white;color:black;"></div>
              <textarea id="editor-html" style="display:none;width:100%;height:300px;font-family:monospace;font-size:1em;"></textarea>
            </div>
            <div style="flex:1;min-width:350px;">
              <label style="font-weight:bold;">Vista previa:</label>
              <div id="preview-html" style="border:1px solid #ccc;background:#fff;color:#222;padding:8px;min-height:300px;"></div>
            </div>
          </div>
          <button id="btn-guardar-pagina" style="margin-top:10px;">Guardar Cambios</button>
        </div>
      </div>
    </section>
  </main>
  <footer class="footer">
    <div class="footer-col">
      <h3>Direcci√≥n</h3>
      <p>Direcci√≥n: Av. Amazonas y Col√≥n, Quito ‚Äì Ecuador</p>
    </div>
    <div class="footer-col">
      <h3>S√≠guenos</h3>
      <div class="footer-socials">
        <a href="https://api.whatsapp.com/send?phone=593997000496&text=%C2%A1Hola%20Iyayku%20Innova%20Editores!%20me%20gustar%C3%ADa%20saber%20m%C3%A1s%20informaci%C3%B3n%20acerca%20de%20la%20asesor%C3%ADa%20y%20publicaci%C3%B3n%20de%20art%C3%ADculos%20cient%C3%ADficos.%20%E2%9C%8D%EF%B8%8F%F0%9F%93%8A%F0%9F%93%9D" target="_blank" rel="noopener noreferrer">
          <img src="/img/whatsapp" alt="WhatsApp" />
        </a>
        <a href="https://www.facebook.com/Iyaykutec" target="_blank" rel="noopener noreferrer">
          <img src="/img/facebook" alt="Facebook" />
        </a>
        <a href="https://www.instagram.com/iyaykutec" target="_blank" rel="noopener noreferrer">
          <img src="/img/instagram" alt="Instagram" />
        </a>
      </div>
    </div>
    <div class="footer-col">
      <h3>Informaci√≥n</h3>
      <p>Email: iyayku@gmail.com</p>
      <p>Tel√©fonos: 0995000484 ¬∑ 0979369650 ¬∑ 0997000496</p>
    </div>
  </footer>
  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
  <script src="/script.js"></script>
  <script>
    // Mostrar banner de login si est√° logueado
    document.addEventListener('DOMContentLoaded', function() {
      fetch('/api/status', { credentials: 'include' })
        .then(res => res.json())
        .then(data => {
          if (data.usuario && data.usuario.correo) {
            const banner = document.getElementById('login-status-banner');
            const text = document.getElementById('login-status-text');
            const perfilLink = document.getElementById('perfil-link');
            text.textContent = `Sesi√≥n iniciada: ${data.usuario.nombre || data.usuario.correo}`;
            if (data.usuario.correo === 'admin@iyayku.com') {
              perfilLink.style.display = '';
            } else {
              perfilLink.style.display = 'none';
            }
            banner.style.display = '';
          }
        });
    });
  </script>
    <script src="/script.js"></script>
</body>
</html>
